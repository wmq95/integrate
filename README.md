# integrate
## 自身涉及到的spring的功能等整合
基于Spring boot，Spring cloud Netflix

### 组件

1）数据库方面采用mysql ，orm 使用mybatisPlus

2）对于容器方面，选择了undertow 做为容器

3）对于服务注册：由于eureka 已停止服务，采用阿里的nacos 正好还nacos还能够当作配置中心

4）使用gateway作网关，所有服务基于spring security 保护采用jwt Token 形式，也实现了Oauth2 协议

5）分布式事务采用seata (配置中心方式)实现强一致性，对于高并发场景例如秒杀，采用rocketMq 事务消息机制实现

6）存储引擎使用es

7）日志模块elk

8）监控采用prometheus

### TODO

### 1 sharding JDBC

使用sharding JDBC 实现读写分离 有2点不顺心得地方:

​	一个是侵入性高，需要做做好业务功能配置，而且在测试的时候 发现在一个service方法中如果有新增和读取2个操作 默认得话新增是主库 读取时从库 ，这样总会出现问题。当然也可以通过强制走主库得方法解决.

​	第二个应该算是mysql实现高可以用得方面 不算是sharding-JDBC。我们在后台配置总是配置了数据库得ip 那么如果数据库宕机了，整个服务就不能用了？怎么解决呢？ 有个方案就是**多主多从，然后使用代理**(类似nginx，亲测使用nginx 做代理 然后项目中数据源url 配置代理得地址，当我有2个主库 一个出现宕机得时候，另一个可以做为备用，项目可以访问备用得数据库)

### 思考

####  使用mysql 主从复制 数据同步得时候怎么解决数据不一致(写入主库，从库还没有同步数据)

可以由业务设置读取走主库查询,**主从不可避免得带来了延迟问题**。

####  分库分表怎么做另一个维度得查询

使用es做查询




